---
key: /2023/01/30/Week10-Day1,2,3.html
title: TIL-10주차 코드
tags: java oracledb servlet jsp 
---

# 1.  OracleDB : 230130

### 0) 오라클DB 설정

- 서비스 이름 : xepdb1  입력 후 테스트 버튼 누르고 접속 버튼 누르기 

---

<br>

### 1) SQL : 

- DDL(CREATE, ALTER, DROP) : 테이블 
- DML(INSERT, SELECT, UPDATE, DELETE) : CRUD(주로 쓴다!)
- DCL : 허가, 허락, 취소 등 

<br>
- 테이블 정의하기 : 데이터 구조 정의하기 : 개념상의 데이터
- 오라클에서는 정수/실수를 따로 구분하지 않는다.(NUMBER)
- 오라클에서는 문자와 문자열을 따로 구분하지 않는다.(VARCHAR2) 
- 문자는 ''로 쓰고 ""는 아니다. 

---

<br>
- 오라클DB의 데이터 타입 :
 
	- CHAR : 바이트 단위이다. 데이터 크기를 4000바이트까지 쓸 수 있다. 고정된 길이로 된 데이터 타입으로 검색하면, 검색이 빠르다. 
	
	- VARCHAR2 : CHAR보다 큰 단위이다. 하지만, 검색 속도는 느리다. 
	
	- NVARCHAR2 :영어도 한글도 모두 2바이트로 인식하게 해준다.(원래는 영어가 1바이트, 한글이 3바이트 였다. )
	
	- DATE 형식(BC 단위의 날짜 형)
	- TIMESTAMP 형식(시간 까지 포함한 날짜이다. 현재 시간을 출력 가능 ) 
	- 다른 나라와의 주문 날짜를 맞추려면 서버에 타임존 설정을 맞춰야 한다.
	
	- LONG : 테이블에서 한 칼럼만 전송할 파일을 2기가까지만 설정할 수 있다.(예전에는 이미지 파일에서 사용했고, 제한적이다.)
	
	- CLOB : 대용량 텍스트 타입(4000바이트 이상!)
	
	- NCLOB : 전송할 파일이 최대 4기가 바이트이고 여러 칼럼에도 쓸 수 있다.
	
---

<br>
- 실습 코드 : 

```
// 테이블 생성 
CREATE TABLE MEMBER3144(
    ID  NUMBER,
    NAME NVARCHAR2(100),
    PWD NVARCHAR2(100),
    EMAIL   VARCHAR2(100)
)

// 테이블 삭제
DROP TABLE MEMBER3144;

// INSERT INTO MEMBER3144(ID, NAME) VALUES IN(2,'가나다'); 

// 문자열 길이 출력
SELECT LENGHB('가나다') FROM MEMBER3144; 

```

---

<br><br>

```
// 퀴즈에 대한 정답 1
NUMBER
NVARCHAR2(1000)			// 한국에서 운용하므로 NVARCHAR2이다. 
NVARCHAR2(100)
CLOB
TIMESTAMP 				// DATE가 아니라 TIMESTAMP이다.
NUMBER
VARCHAR				// 파일은 디스크에 저장하고 경로만 저장한다! 그래서 NCLOB이 아니라 VARCHAR이다. 보통 영어로 파일명을 쓰므로 

// 퀴즈에 대한 정답 2 : COMMENT
NUMBER
CLOB
DATE
VARCHAR2
VARCHAR2
```

---

<br>
- 웹서버와 파일스토리지 그리고 DBMS와의 관계 :  
	- 파일 용량이 커서 DBMS에 파일을 저장하는 것은 비효율적이고 파일 경로만 저장한다. 
	- 사용자 입장에서는 웹서버를 하나만 있다고 알고 있게 하고 실제로는 웹서버가 여러개로 있으며 합쳐져서 로드가 된다. 파일 경로를 DBMS에서 찾아서 파일스토리지에 가기 전 중간 공간에서 경로를 비교해 알맞은 경로에서 파일을 찾아 사용자에게 반환해준다.   


---

<br><br>
# 2.  OracleDB : 230131


### 1) SQL 기본(암기) : 

- COMMIT, ROLLBACK : commit을 해야 데이터가 업데이트된다. Rollback은 데이터를 수정한 것을 다시 되돌릴 수 있다. 

- 데이터 삽입 : INSERT INTO MEMBER(ID, PWD, NICNAME) VALUES(2, 22, 'suesue');

- 데이터 수정 : UPDATE MEMBER SET NICNAME='NEWNEW';

- 데이터 삭제 : DELETE MEMBER WHERE ID=22;

- 칼럼을 별명으로 사용 가능 : select id, name, pwd as password from member;



<br>
### 2) JDBC 

- JDBC : 남이 만든 플랫폼을 중간역할을 통해 문제를 해결하게 해준다. 

- 원래는 MS사의 odbc로부터 jdbc가 만들어진 것이다. 

- DriverManager, Connection, Statement, Resultset



<br>
### 3) 간단히 배포하는 방법 :

- 이클립스에서 배포하고 싶은 코드를 우측 클릭하여 export하면, java 탭에서 jar파일로 만들 수 있다. 


<br>
### 4) 외부파일을 불러들여 값으로 클래스 정보를 받아와서 객체(인스턴스 ) 생성하기 : 

<br>
- res/setting.txt

```text
	com.newlecture.web.entity.Menu
```

<br>
- Program.java

```java
import java.io.FileInputStream;
import java.io.IOException;
import java.lang.reflect.InvocationTargetException;
import java.util.Scanner;

import com.newlecture.web.entity.Menu;

public class Program {

	public static void main(String[] args) throws IOException, InstantiationException, IllegalAccessException, ClassNotFoundException, IllegalArgumentException, InvocationTargetException, NoSuchMethodException, SecurityException {
		
		Menu menu = new Menu();
		menu.setName("아메리카노");
		System.out.println(menu);
		
		FileInputStream fis = new FileInputStream("res/setting.txt");
		Scanner scan = new Scanner(fis);
		
		String clsName = scan.nextLine();				// clsName은 값인데 이것을 객체로 만드는 방법은 new로 하면 안된다.
																					// 해결방법은? Class.forName으로 만든다! 
		
		Menu menu1 = (Menu) Class.forName(clsName).newInstance();			// 값을 객체로 만들기!
		
		//Menu menu1 = (Menu) Class.forName(clsName).getDeclaredConstructor().newInstance();
		
		
		menu1.setName("카페라떼");
		System.out.println(menu1);
		
		
		scan.close();
		fis.close();
	}

}

```

---

<br>
### 5) JDBC로 오라클DB 연동시키기 : 

```java
package com.newlecture.web.jdbc;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class JDBCProgram {

	public static void main(String[] args) throws ClassNotFoundException, SQLException {
//		DriverManager			// Class.forName :  new와 같은 역하링다. 뭐 입력 받을지 모르기 때문에 new로 쓸수 있는 것 아니라서 Class.forName이다.  
//		Connection				// 드라이버와 연결
//		Statement					// 업데이트 하려는 쿼리문이 여기 안에 들어 있다. 
//		Resultset					// 쿼리의 결과를 확인하기 위해서 사용된다. 
		
		Class.forName("oracle.jdbc.driver.OraleDriver");			// 스태틱 생성자와 같이 바로 불러낼 수 있다. 
		
		// https://service/a/b/c와 같이 http라는 프로토콜에 service 객체에 a,b,c 순으로 파일이 이동된다.
		// thin 도 약속되어있는 명칭이다.
		String url = "jdbc:oracle:thin:@oracle.newlecture.com:1521/xepdb1";				// xepdb1는 SEED로부터 복제된 샘플(플러그된 것에서 복제 )이다. 
																																					// 조작을 아무렇게 해도 된다!
		
		Connection con = DriverManager.getConnection(url, "NEWLEC", "rland");

		Statement st = con.createStatement();
		ResultSet rs = st.executeQuery("select * from member");
		
		
		{
			rs.next();
			String nicName = rs.getString("nicname");
			System.out.println(nicName);
		}
		
		
		{
			rs.next();
			String nicName = rs.getString("nicname");
			System.out.println(nicName);
		}		
		
		{
			rs.next();
			String nicName = rs.getString("nicname");
			System.out.println(nicName);
		}
		
		System.out.println(con.isClosed());
		
		con.close();			// 습관적으로 닫아주자!  나중엔 커넥션 에러가 발생한다!! 
		
	}

}

```

<br>
-  실행 결과! :

```
	1004
	□■□■□■
	ㅇㅇ
	false
```

---


<br><br>
# 3. 230131
