---
key: /2023/02/20/Week13-Day1,2,3html
title: TIL - 13주차 코드
tags: git java servlet jsp spring
---


# 0-1. Git 시작

<br>
### 1) VSCODE 에서 이용 

- vscode에서 터미널 탭 - 새 터미널 클릭 후 
- ctrl + shift + p 입력 후 
- 검색 창에서 select default bash 입력 후 bash 선택

<br>
### 2) 로컬에서 git 명령어 정리 : 

- git --help로 검색어 공부

- git init으로 초기화 해주기 

- git add ~~ : 추적 상태로 만들기

- git rm --cached lecture-schedule.html : 현재 추적 상태이지만 그 상태를 빼주기 

- git config --global user.email address 

- git commit  : 새로운 창이 뜨면 코멘트를 간단히 적어주기 '초기 git 수업 예'

- 코멘트 작성하고 `esc` 후 `:wq`로 나와서 `git status`로 확인 : `git status -s`

- git checkout master(해쉬코드도 들어갈 수 있다.) : 해당 시점이나 다시 되돌아갈 수 있다.

- git checkout 해쉬코드 : 해당 시점으로 돌아가서 코드를 볼 수 있다. 

- git commit -m "커밋 코멘트 추가 "

- git show h-list.html : 해당 파일이 변화된 모습을 확인할 수 도 있다.(엔터 치고 변화된 모습을 확인하고 q를 누르면 나올 수 있다.)

- git commit -am "" : add하고 commit하  코멘트 쓰는 것까지 한번에 할 수 있다.

---

- git diff : status의 변경 사항을 확인할 수 있다. 





---

<br><br>
# 0-2. Git branch











---

<br><br>
# 1. Front Controller : 230220

### 1) 이전 시간 복습 

- 서블릿을 통한 입출력은 request와 response 밖에 없다. 

- 이전 시간에는 서블릿을 통해서 입력 받는 방법을 배움. 

<br>
- 입력부분과 Dispatcher 부분이 잘려나가고(서블릿 부분이 잘려나간다.) 순수 자바코드인 POJO만 남는다.
	- 잘려진 부분은 클라이언트 쪽으로 보낸다.

---

<br>
### 2) POST 전송 방식 

<br>
- POST 요청 구분 :  
	- 데이터가 클 때, 한 번에 많은 데이터를 전송할 때, POST 방식으로 보낸다. 기입할 때, form 방식으로 제출하고 제출하는데 이 때, POST 요청으로 보낸다.
	- e.g. 검색은 GET 요청이다. // 회원 가입은 값을 달라는 것이 아니라 기입만 하는 것이라서 POST 방식이다.
	- 애매하게 값을 달라고하면서 기입하는 데이터가 많은 경우에 POST 전송으로 보낸다.
	- GET 요청과 구분하기!

<br>
- POST 전송 특징 :
	- 요청 header가 아니라 요청 body에 데이터가 들어가서 URL에서 데이터가 보여지지 않는다.

```html
<form action="/webprj2/input" method="get">
		<fieldset>
			<legend>쿼리 값</legend>
			<label>page:</label>
			<input type= "text" name="p"><br>
			<label>검색어1:</label>
			<input type= "text" name="q1"><br>
			<label>검색어2:</label>
			<input type= "text" name="q2"><br>
			<label>검색어3:</label>
			<input type= "text" name="q3"><br>
			<label>size:</label>
			<input type= "text" name="s"><br>
		</fieldset>
		<fieldset>
			<legend>취미</legend>
			<input type="checkbox" name="hb" value="1">
			<label>탁구</label>
			<input type="checkbox" name="hb" value="2">
			<label>독서</label>
			<input type="checkbox" name="hb" value="3">
			<label>술</label>
		</fieldset>
		<input type= "submit" value="제출">
</form>
```

- 쿼리스트링은 사용자가 선택하는 값이다. 

- 사용자가 입력하는 경우, form을 이용한 쿼리스트링 입력이다. GET 방식

- Post 방식은 form을 이용할 때, 사용자가 입력한 값이 매우 클 경우, article 같은 경우! POST를 사용한다.(보안과는 별개다)


---


<br>
### 3) 쿠키(Cookie)

- 서버가 사용자에게 주는 데이터이다. 새로운 사용자로 인식하지 않게 한다. 기존 사용자로 인식하게 해준다.

- 쿠키는 상태값을 저장하는 경우에 사용한다.

<br>
- 웹의 저장소 : Request, Session, Application 
	- Session, Application은 서블릿이 사라져도 데이터가 남아 있다. 서버에 저장된다.

<br>	 
- forward 관계에서 종료되면 데이터는 같이 사라진다.

---

<br>	
- 3-1. 세션
	- 서버에 사용자 데이터를 저장하는 공간(기간을 말한다.)
	- 세션은 사전적인 의미로 허용된 사용 기간을 말한다.
	- 웹에서는 커넥션이 없어서 연결 유지가 안 될때, 세션을 사용한다. 
	- 세션 기간은 기본 30분으로 설정되어 있다. 
	- 세션 타임아웃되기 전에 그 회원에게 세션 저장소(객체)에 세션 키를 저장해놓는다.
	- 첫 번째 서버 요청에는 세션키가 없다. 2번째 서버 요청 이후부터 세션키가 발급된다.
	- html은 정적인 파일이라서 세션을 부여해줄 필요가 없다. 

<br>
- 3-2. 세션 객체 
	- ListController3에서 서블릿 세션을 부여하고 ListController2에서 서블릿이 그 세션을 공유하여 출력한다.
	- 서블릿들이 공유하여 사용한다. 
	- 요청자들에 준하여 세션을 공유한다.
	- 요청자가 다르면, 세션 공간을 다르게 공유한다.

---

<br>
- 실습 코드 :
- ListController4.java

```java
package com.newlecture.web.controller.menu;

import java.io.IOException;
import java.io.PrintWriter;
import java.util.ArrayList;
import java.util.List;

import com.newlecture.web.entity.Menu;
import com.newlecture.web.service.DefaultMenuService;
import com.newlecture.web.service.MenuService;

import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.Cookie;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import jakarta.servlet.http.HttpSession;

@WebServlet("/menu/list4") //존재하지않는 리소스 요청시 404에러
public class ListController4 extends HttpServlet{
      
   private MenuService service;
   
   public ListController4() {
      service= new DefaultMenuService();
   }
   

   @Override                  // doGet 뿐만 아니라 doDelete, doPut, doPost, doHead 등이 있다.
   protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {

      resp.setContentType("text/html; charset=utf-8");
      req.getParameter("c");
      
      PrintWriter out = resp.getWriter();

      
      
//      List<Menu> menus = service.getList();
      List<Menu> menus = new ArrayList<>();
      
      //세션으로 보내기
      HttpSession session = req.getSession();
      session.setAttribute("haha", "hoho");

      // 내용을 전달
      req.setAttribute("menus", menus);

      // 포워딩 방식
      req
      .getRequestDispatcher("/WEB-INF/view/menu/list.jsp")
      .forward(req, resp);
   }
}

```

---

<br>
- ListController2.java

```java
package com.newlecture.web.controller.menu;

import java.io.IOException;
import java.io.PrintWriter;

import com.newlecture.web.service.MenuService;

import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import jakarta.servlet.http.HttpSession;

@WebServlet("/menu/list2")
public class ListController2 extends HttpServlet {

   private MenuService service;

   @Override // doGet 뿐만 아니라 doDelete, doPut, doPost, doHead 등이 있다.
   protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {


      PrintWriter out = resp.getWriter();

      resp.setContentType("text/html; charset=utf-8");
      

      // 서블릿은 메인함수 직접 작성하지 않고입출력 도구가 달라짐!
      
      HttpSession session = req.getSession();
      String haha = (String) session.getAttribute("haha");
      
      System.out.println(haha);

      req.getRequestDispatcher("/WEB-INF/view/menu/list.jsp").forward(req, resp);


   }
}
```

---

<br>
- 3-3. 쿠키
- 클라이언트에 저장하는 사용자 데이터
- 서버에 부담도 줄여준다.
- 브라우저를 닫아도 쿠키를 기록할 수 있고 쿠키를 가져갈 수 있다.(1년 or 10년 기간 설정 가능)
- 기간도 설정 가능 : 

- setPath("/") : 경로 설정 가능!
- setMaxAge : 분 단위로 쿠키 시간 설정 가능 
- 쿠키는 문자열만 저장할 수 있다. 그 외의 값들은 JSON이라는 형태로 바꿔서 url로 사용할 수 있는 방식으로 인코딩해서 넣어줘야 한다.

---

<br>
- 실습 코드 :
	- ListController4.java

```java

package com.newlecture.web.controller.menu;

import java.io.IOException;
import java.io.PrintWriter;
import java.util.ArrayList;
import java.util.List;

import com.newlecture.web.entity.Menu;
import com.newlecture.web.service.DefaultMenuService;
import com.newlecture.web.service.MenuService;

import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.Cookie;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import jakarta.servlet.http.HttpSession;

@WebServlet("/menu/list4") //존재하지않는 리소스 요청시 404에러
public class ListController4 extends HttpServlet{
      
   private MenuService service;
   
   public ListController4() {
      service= new DefaultMenuService();
   }
   

   @Override                  // doGet 뿐만 아니라 doDelete, doPut, doPost, doHead 등이 있다.
   protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {

      resp.setContentType("text/html; charset=utf-8");
      req.getParameter("c");
      
      PrintWriter out = resp.getWriter();

      
      
//      List<Menu> menus = service.getList();
      List<Menu> menus = new ArrayList<>();
      
      //세션으로 보내기
//      HttpSession session = req.getSession();
//      session.setAttribute("haha", "hoho");
      
      //쿠키 만들어 보내기
      Cookie cookie = new Cookie("haha", "hoho");
      cookie.setPath("/");
      cookie.setMaxAge(30);
      
      resp.addCookie(cookie);

      // 내용을 전달
      req.setAttribute("menus", menus);

      // 포워딩 방식
      req
      .getRequestDispatcher("/WEB-INF/view/menu/list.jsp")
      .forward(req, resp);
   }
}
```



