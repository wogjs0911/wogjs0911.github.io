---
key: /2023/04/10/Week20-Day.html
title: TIL - 20주차 코드
tags: springboot RESTAPI Vue.js NodeJS npm component 
---

# 1. 인증과 권한 : 230403


### 1) Session 개념

#### a. Session 로직 

##### a) 조건 1 

- 세션 / 쿠키를 이용해서 사용자가 인증되었던 적이 있는지를 확인함.
- if 너 로그인 했니? 
- 아니요 -> 로그인하고 와

<br>

##### b)  조건 2

- if 너 로그인 햇니? 
- 네 -> if(그럼 너 어드민 이니?)
- 아니요 -> 권한이 없다~ 얘.

<br>

#### b. Session-Id 개념 

- 세션아이디는 서버자원을 사용하는 것이기 때문에 인증을 하면 그때 키(세션아이디, 세션키)가 부여받게 된다.**


```java
package kr.co.rland.web.controller.admin;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;

import jakarta.servlet.http.HttpServletRequest;

@Controller("adminHomeController")
@RequestMapping("/admin")
public class HomeController {
	
	@GetMapping("index")
	public String index(HttpServletRequest request) {

		// **session id 부여**
		// 아직 테스트만 했다. 중요하지 않다. sessionkey가 언제만들어지는지 확인!!
 		request.getSession().setAttribute("test", "hehe");

		return "admin/index";
	}

}

```

---

<br><br>

### 2) 로그인 기본 방식 


#### a. 기능 


- Member.java

```java

@Data
@NoArgsConstructor
@AllArgsConstructor
@ToString
public class Member {

    private Long id;
    private String userName;
    private String pwd;
    private String email;
    private Long roleId;
    
}

```


<br>
- UserController.java

```java

@Controller
@RequestMapping("/user")
public class UserController {
    
    @Autowired
    private MemberService memberService;


    // 회원이 탈되되어도 사용자 이름이랑 식별자는 남긴다.
    @GetMapping("login")
    public String login(String uid, String pwd){

        // Member member= memberService.getByUseName(uid);
        
        // 우리는 컨트롤러에서 입력만 받으면 된다. 
        // 컨트롤러에서 모든 것을 업무하면 안 된다. 그래서 위의 서비스는 사용하지 않는다. 
        // id를 가져와서 컨트롤러에서 처리하기 때문이다.
        boolean isValid = memberService.isValidMember(uid, pwd);

        return "user/login";
    }

}

```


<br>
- MemberService.java

```java
package kr.co.rland.web.service;

public interface MemberService {

    // Member getByUseName(String uid);

    boolean isValidMember(String uid, String pwd);
    
}

```



<br>
- DefaultMemberService.java

```java

@Service
public class DefaultMemberService implements MemberService {
   
    @Autowired
    private MemberRepository repository;

    @Override
    public boolean isValidMember(String uid, String pwd) {
        
        Member member = repository.findByUserName(uid);
        
        return false;
    }
}

```


<br>
- MemberRepository.java

```java

@Mapper
public interface MemberRepository {
    Member findByUserName(String uid);
}

```



