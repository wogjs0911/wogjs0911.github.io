---
key: /2023/05/22/Week26-Day.html
title: TIL - 26주차 코드
tags: Java StreamAPI
---

# 1. 230522


### 1) Stream API : 전체 코드

- Program.java

```java
package main.java.ex4.stream;

import java.io.IOException;
import java.util.regex.Pattern;
import java.util.stream.IntStream;


public class Program {
    public static void main(String[] args) throws IOException {
        
        ExamRepository repository = new ExamRepository();
        // List<Exam> list = repository.getList(1);
        // list.forEach(System.out::println);

        // ** Stream API 이용! : 파일 읽어서 사용하기 **
        Exam exam = repository.get(1);
        System.out.println(exam);

        int sum = repository.getKorSum();
        System.out.printf("sum is : %d\n", sum);

        // ** Stream API 이용!! : 문자열 쪼개기 **
        String line = "2,3,4,5";
        Pattern
        .compile(",")
        .splitAsStream(line)
        .limit(2)   // 최대 개수 2개
        .forEach(System.out::println);

        // ** Stream API 이용!! : 박싱하는 방법 : Int -> Integer 형식으로 바꾸기! **
        int[] ages1 = {10,23,34,42,12,24};

        IntStream stream1 = IntStream.of(ages1);
        stream1
        .boxed()
        .toList()
        .forEach(System.out::println);  // ages1 배열의 원소를 1줄씩 끊어서 출력!!

        // System.out.println(list);
        // Int, Doutble, LongStream <->  Stream
        
        // 스트림 사용하는 방법 
        // 1. 콜렉션 
        // 2. 배열
        // 3. 파일

        // int[] ages1 = {10,23,34,42,12,24};
        // IntStream stream1 = IntStream.of(ages1);   // 아래의 Stream 부분과 다르다.
        // stream1.average();

        // List<Integer> ages2 = new ArrayList<>();
        // Stream<Integer> stream2 = ages2.stream();
        // Optional<Integer> firstNum = stream2.findFirst();
        
        // // **Optional은 반환값이 없을 수도 있고 있을 수도 있을 때, 사용한다. 
        // // firstNum.isPresent();

        // // 확실히 반환값이 몇개인지 확인하기!
        // long count = stream2.count();

        // // '데이터 분석하기' : lines는 라인 하나 하나가 데이터를 읽어들이게 된다.
        // // map, reduce 함수도 있다.
        // Files
        // .lines(Path.of("res/data.csv"))
        // .toList()  // toList()는 최종 출력 단계이다. forEach문으로 출력(소비) 가능!
        // .forEach(System.out::println);  // 아래의 람다식과 같은 표현식이다.('funtional Expression')
        // // .forEach(line -> {      // 보통, 소비할 때인 테스트에서 사용된다. 
        // //     System.out.println(line);
        // // });



    }
}

```


---

<br>
- ExamRepository.java

```java
package main.java.ex4.stream;

import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.util.List;
import java.util.Optional;

public class ExamRepository {

    public Exam get(int id){

        Optional<Exam> result = null;

        try {
            result = Files
            .lines(Path.of("res/data.csv"))
            .skip(1)    // 파일의 첫 줄 스킵하기
            .map(Exam::fromCSV)    // map으로 따로 빼서 매핑 사용 가능
            .filter(exam->exam.getId() == id)
            .findFirst();    // findFirst는 첫 필터링되어 1개만
            // .findAny()  // findAny는 필터링의 1개만 랜덤하게 출력 

        } catch (IOException e) {

            e.printStackTrace();
        }

        if(result.isPresent())
            return result.get();

        // .toList();
        return null;
    }
    
    public List<Exam> getList(int page){
        int size = 5;
        int offset = (page-1)*size;

        List<Exam> list = null;

        try {
            list = Files
            .lines(Path.of("res/data.csv"))
            .skip(1)    // 파일의 첫 줄 스킵하기
            .map(Exam::fromCSV)    // map으로 따로 빼서 매핑 사용 가능
            .filter(exam->exam.getKor() == 90)
            .skip(offset)
            .limit(size)
            .toList();
            // .forEach(System.out::println);
            // .line(->{     // map은 형식을 변경하기.
                // String[] tokens = line.split(",");

                // int kor = Integer.parseInt(tokens[0]);
                // int eng = Integer.parseInt(tokens[1]);
                // int math =  Integer.parseInt(tokens[2]);

                // Exam exam = new Exam(kor,eng,math);
                // return exam;
            // })
            

        } catch (IOException e) {

            e.printStackTrace();
        }
        // .toList();
        return list;
    }

	public int getKorSum() {

        try {
            Files
            .lines(Path.of("res/data.csv"))
            .skip(1)    // 파일의 첫 줄 스킵하기
            .map(Exam::fromCSV)    // map으로 따로 빼서 매핑 사용 가능
            .mapToInt(exam->exam.getKor())
            // // .sum()은 기본형식이 아니라서 forEach로 매번 더해서 바꾸거나 Integer형 Stream에서 Int 배열로 변경해줘야 한다.
            // // mapToInt(n->n.intValue())   // 이 식을 아래처럼 하나로 바꿔주자.
            // .map(exam->exam.getKor()) // exam을 kor로 반환해준다!
            // .mapToInt(Integer::intValue) // 기본형을 바꿔준다.
            .sum();
            // .average():

        } catch (IOException e) {
            e.printStackTrace();
        }
        // .toList();
        return 0;
	}
}

```

---

<br>

- Exma.java

```java

package main.java.ex4.stream;

public class Exam implements Comparable<Exam> {
   private int id;
   private int kor;
   private int eng;
   private int math;

   public Exam() {
   }

   public Exam(int id, int kor, int eng, int math) {
      this.id = id;
      this.kor = kor;
      this.eng = eng;
      this.math = math;
   }

   public int getId() {
      return id;
   }

   public void setId(int id) {
      this.id = id;
   }

   public int getKor() {
      return kor;
   }

   public void setKor(int kor) {
      this.kor = kor;
   }

   public int getEng() {
      return eng;
   }

   public void setEng(int eng) {
      this.eng = eng;
   }

   public int getMath() {
      return math;
   }

   public void setMath(int math) {
      this.math = math;
   }

   public int total() {
      return kor + eng + math;
   }

   public static Exam fromCSV(String csv){
      String[] tokens = csv.split(",");

      int id = Integer.parseInt(tokens[0]);
      int kor = Integer.parseInt(tokens[1]);
      int eng = Integer.parseInt(tokens[2]);
      int math =  Integer.parseInt(tokens[3]);

      Exam exam = new Exam(id,kor,eng,math);
      return exam;
    }

   @Override
   public String toString() {
      return "Exam [kor=" + kor + ", eng=" + eng + ", math=" + math + ", id=" + id+ "]";
   }

   @Override
   public int compareTo(Exam exam) {
      return this.total() - exam.total();
   }
}
```

---

<br>
- data.csv

```csv
id,kor,eng,math
1,50,30,50
2,90,80,70
3,100,30,50
4,23,34,45
5,42,34,54
6,100,100,100
7,0,0,0
8,2,3,4
```

### 5) reduce :

- reduce : 내가 원하는 데이터로 추출하는 것

```java
package main.java.ex4.stream;

import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.util.List;
import java.util.Optional;
import java.util.OptionalInt;

public class ExamRepository {

    public Exam get(int id){

        Optional<Exam> result = null;

        try {
            result = Files
            .lines(Path.of("res/data.csv"))
            .skip(1)    // 파일의 첫 줄 스킵하기
            .map(Exam::fromCSV)    // map으로 따로 빼서 매핑 사용 가능
            .filter(exam->exam.getId() == id)
            .findFirst();    // findFirst는 첫 필터링되어 1개만
            // .findAny()  // findAny는 필터링의 1개만 랜덤하게 출력 

        } catch (IOException e) {

            e.printStackTrace();
        }

        if(result.isPresent())
            return result.get();

        // .toList();
        return null;
    }
    
    public List<Exam> getList(int page){
        int size = 5;
        int offset = (page-1)*size;

        List<Exam> list = null;

        try {
            list = Files
            .lines(Path.of("res/data.csv"))
            .skip(1)    // 파일의 첫 줄 스킵하기
            .map(Exam::fromCSV)    // map으로 따로 빼서 매핑 사용 가능
            .filter(exam->exam.getKor() == 90)
            .skip(offset)
            .limit(size)
            .toList();
            // .forEach(System.out::println);
            // .line(->{     // map은 형식을 변경하기.
                // String[] tokens = line.split(",");

                // int kor = Integer.parseInt(tokens[0]);
                // int eng = Integer.parseInt(tokens[1]);
                // int math =  Integer.parseInt(tokens[2]);

                // Exam exam = new Exam(kor,eng,math);
                // return exam;
            // })
            

        } catch (IOException e) {

            e.printStackTrace();
        }
        // .toList();
        return list;
    }

	public int getKorSum() {

        OptionalInt result = null;

        try {
            result = Files
            .lines(Path.of("res/data.csv"))
            .skip(1)    // 파일의 첫 줄 스킵하기
            .map(Exam::fromCSV)    // map으로 따로 빼서 매핑 사용 가능
            .mapToInt(exam->exam.getKor())
            .reduce((a,b)-> a+b);   
            // reduce는 집계하는 것이다. a.getKor()에서 getKor()를 빼는 이유 위에서 exam.getKor()가 있어서!! 

            // // .sum()은 기본형식이 아니라서 forEach로 매번 더해서 바꾸거나 Integer형 Stream에서 Int 배열로 변경해줘야 한다.
            // // mapToInt(n->n.intValue())   // 이 식을 아래처럼 하나로 바꿔주자.
            // .map(exam->exam.getKor()) // exam을 kor로 반환해준다!
            // .mapToInt(Integer::intValue) // 기본형을 바꿔준다.
            // .sum();
            // .average():

        } catch (IOException e) {
            e.printStackTrace();
        }
        // .toList();
        return 0;
	}
}

```


---

<br><br>

### 6) 리눅스 

- `drwxr-x--- 9 nwelec newlec` : 앞의 newlec은 소유자이고 뒤의 newlec은 그룹이다.  

- `sudo chmod 757 dragon /` : '755' 권한을 '757'로 바꾸기('755' 권한은 기존의 dragon 권한이다.) -> 이제는 '읽고 쓰고 실행' 가능한 것!!
	- 이렇게 하면, 나머지 폴더가 other 권한으로 내려간다.

- `ls -l` : 디렉토리 내부의 파일 목록 출력하는데 파일의 권한도 확인 할 수 있다.  

- 예전에는 telnet을 사용했지만 요즘에는 telnet을 사용하지 않는다. 대신 SSH(secure shell)를 사용한다. 

- `scp` : secure copy : 안전하게 복사하기!!


---

<br><br>


#### c. 오너 변경하기 ! 

- chown 명령어


- sudo chown heon5th:heon5th heon5th -> 이 유저(소유자:그룹)에게 소유권을 넘겨준다. 

- 내가 가진 권한을 남에게 넘겨줄 수도 있다.

---

<br><br>

#### d. 파일을 관리하는 방법 :

- 압축하는 방법

- 압축한 것을 풀기

- 패키지 install 하기 
	- 이것은 향상된 툴을 사용한다. : 이젠, apt 툴을 사용한다!1







