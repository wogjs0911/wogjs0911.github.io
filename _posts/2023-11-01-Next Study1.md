---
key: /2023/11/01/Next-Study1.html
title: Next - NextJS Study1
tags: NextJS pageRouter getServerSideProps 
--- 

# 1. Next.js 

### 1) Next.js ê°œë… 

- Next.jsëŠ” ì˜¤í”ˆ ì†ŒìŠ¤ JS `í”„ë ˆì„ì›Œí¬`ì´ë‹¤. React.jsëŠ” ì˜¤í”ˆ ì†ŒìŠ¤ JS `ë¼ì´ë¸ŒëŸ¬ë¦¬`ì´ë‹¤.

<br>
- Next.jsëŠ” Reactì™€ ë§¤ìš° ìœ ì‚¬í•˜ê³  ëª‡ê°€ì§€ ë©”ì„œë“œì™€ ê°œë…ì´ ì¶”ê°€ëœë‹¤. ê·¸ë˜ì„œ React.jsì˜ í™•ì¥íŒì´ë‹¤.

<br>
- ê°œë°œ ì‹œ, Next.jsëŠ” í”„ë ˆì„ì›Œí¬ì—ì„œ ì •í•´ë†“ì€ ë°©ë²•ëŒ€ë¡œ ê°œë°œì„ í•´ì•¼ í•œë‹¤. ë°˜ë©´, React.jsëŠ” í”„ë¡œê·¸ë˜ë¨¸ê°€ ë¬´ìŠ¨ ë„êµ¬ë¥¼ ì“°ë˜ê°„ì— ìƒê´€ì—†ë‹¤.

<br>
- ë˜í•œ, SSR ë°©ì‹ì„ ì œê³µí•œë‹¤. CSRê³¼ í˜¼í•©í•´ì„œ ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤. ê¸°ìˆ ì , ë¹„ì¦ˆë‹ˆìŠ¤ì ìœ¼ë¡œ ë§¤ìš° íš¨ìœ¨ì´ ì¢‹ë‹¤.

<br>
- SEO(ê²€ìƒ‰ ì—”ì§„)ì— ìµœì í™”ë˜ì–´ ìˆë‹¤.

---

<br><br>

### 2) Next.js í”„ë¡œì íŠ¸ ìƒì„± ë° ë””ë ‰í† ë¦¬ êµ¬ì¡° ì„¤ëª…

- í„°ë¯¸ë„ì—ì„œ Next.js í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•˜ëŠ” ëª…ë ¹ì–´** : `npx create-next-app@latest .`
	- `npx`ëŠ” create-next-appë¼ëŠ” node.js ë¼ì´ë¸ŒëŸ¬ë¦¬(ë³´ì¼ëŸ¬ í”Œë ˆì´íŠ¸ ì—­í• ì„ í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬)ë¡œì„œ ë¡œì»¬ì— ì„¤ì¹˜í•˜ì—¬ ìƒì„±í•˜ì§€ ì•Šê³  ë¹Œë ¤ì„œ ì‚¬ìš©í•˜ëŠ” ê°œë…ì´ë‹¤.
	- ë˜í•œ, next.jsì˜ ë²„ì „ì´ ê³„ì† ë°”ë€Œê¸° ë•Œë¬¸ì—, ìƒˆë¡œìš´ next ì•±ì„ ìƒì„±í•  ë•Œë§Œ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ë¡œì»¬ì— ì„¤ì¹˜í•  í•„ìš”ê°€ ì—†ë‹¤.
	- í•´ë‹¹ ëª…ë ¹ì–´ì—ì„œ '.'ì´ ì¤‘ìš”í•˜ë©°, í„°ë¯¸ë„ì—ì„œ ì…ë ¥ í›„ ìƒì„± ë§ˆë²•ì‚¬ ê³¼ì •ì„ ì§„í–‰í•˜ì—¬ í”„ë¡œì íŠ¸ ìƒì„± ë§ˆë¬´ë¦¬ ì§“ê¸°!!

<br>

- í˜„ì¬ëŠ”, App Routerë³´ë‹¤ëŠ” Page Routerë¥¼ ì‚¬ìš©í•  ì˜ˆì •ì´ë‹¤. App RouterëŠ” ì„œë²„ ì»´í¬ë„ŒíŠ¸ë‚˜ ì„œìŠ¤íœìŠ¤ ë“±ë“±ì˜ ì¶”ê°€ ê°œë…ì´ í•„ìš”í•˜ì—¬ ëŸ¬ë‹ì»¤ë¸Œê°€ ë†’ì•„ì„œ ì¶”í›„ì— ê³µì‹ë¬¸ì„œë¡œ í•™ìŠµí•˜ê¸°!

<br>

- í˜„ì¬ëŠ” .js íŒŒì¼ë¡œ Next.jsì˜ í˜ì´ì§€ë¥¼ ê°€ë¦¬í‚¤ëŠ” ì»´í¬ë„ŒíŠ¸ íŒŒì¼ë¡œì„œ ìƒì„±í•œë‹¤.(ë‚˜ì¤‘ì—ëŠ” tsë¥¼ ì‚¬ìš©)

<br>

- í˜ì´ì§€ì˜ ê²½ë¡œëŠ” ê¸°ë³¸ì ìœ¼ë¡œ `jsconfig.json` íŒŒì¼ì—ì„œ `@/pages`, `@/public` ê²½ë¡œë¡œ ì„¤ì •ë˜ì–´ ìˆë‹¤.

```json
{
  "compilerOptions": {
    "paths": {
      "@/*": ["./*"]
    }
  }
}

```

<br>

- ì¤‘ìš”** : ë””ë ‰í† ë¦¬ êµ¬ì„±ì—ì„œ pages í´ë” ë‚´ë¶€ì— ìˆëŠ” .js íŒŒì¼ë“¤ì€ ê°ê° í˜ì´ì§€ ì—­í• ì„ í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ë¥¼ ì •ì˜í•˜ëŠ” íŒŒì¼ë“¤ì´ë‹¤.(Page Router ê°œë…)

<br>
- Next.jsëŠ” `module css` ë°©ì‹ì„ ì´ìš©í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•œë‹¤.(`/styles/Home.module.css`ì˜ ë°©ì‹ì²˜ëŸ¼)


---

<br><br>

# 2. í˜ì´ì§€ ë¼ìš°í„°

### 1) Page Router ê°œë…

- ì •ì  ê²½ë¡œ í˜ì´ì§€ : post ë””ë ‰í† ë¦¬ 
	- post ë””ë ‰í† ë¦¬ ë‚´ë¶€ì˜ index.jsëŠ” `/post`ë¼ëŠ” ê²½ë¡œë¥¼ ì˜ë¯¸í•œë‹¤. ë¬¼ë¡ , ì‚¬ìš©ìê°€ ì„ì˜ë¡œ ë§Œë“  post ë””ë ‰í† ë¦¬ê°€ ì•„ë‹ˆë¼ pages ë””ë ‰í† ë¦¬ ë°”ë¡œ ì•„ë˜ì— about.jsê°€ ìˆë‹¤ë©´ `/about`ë¼ëŠ” ê²½ë¡œë¥¼ ì˜ë¯¸í•œë‹¤.

<br>
- ë™ì  ê²½ë¡œ í˜ì´ì§€ 1 : post ë””ë ‰í† ë¦¬ ë‚´ë¶€ì˜ [id].js íŒŒì¼
	- `/post/1`ë‚˜ `/post/2`ì²˜ëŸ¼ ë™ì  ê²½ë¡œë¥¼ ì •ì˜í•  ìˆ˜ ìˆë‹¤. 
	
<br>
- ë™ì  ê²½ë¡œ í˜ì´ì§€ 2 : country ë””ë ‰í† ë¦¬ ë‚´ë¶€ì˜ [...code].js íŒŒì¼
	- ì´ëŸ¬í•œ ë°©ì‹ì€ `Catch All Routing`ì´ë¼ê³  ë¶ˆë¦°ë‹¤.
	- `/country` ë’¤ì— ëª¨ë“  ë™ì  ê²½ë¡œë¥¼ ëŒ€ì‘í•´ì¤€ë‹¤.
		- `/country/3/23423/asdf`ì— ëŒ€ì‘í•´ì¤€ë‹¤.

<br>
- ë™ì  ê²½ë¡œ í˜ì´ì§€ 3 : country ë””ë ‰í† ë¦¬ ë‚´ë¶€ì˜ [[...code]].js íŒŒì¼
	- ì´ëŸ¬í•œ ë°©ì‹ì€ í•´ë‹¹ ë™ì ê²½ë¡œê°€ ì—†ì–´ë„ ëŒ€ì‘í•´ì¤€ë‹¤. 404 í˜ì´ì§€ì— ì„¤ì • ê°€ëŠ¥!
	- ì¦‰, 'Optional'í•˜ë‹¤ê³  í•´ì„œ `Optional Catch All Routing`ì´ë¼ê³  ë¶€ë¥¸ë‹¤.

<br>
- ì´ë ‡ê²Œ ë””ë ‰í† ë¦¬ êµ¬ì¡°ë§Œ ë§Œë“¤ë©´, Next.jsê°€ ì•Œì•„ì„œ ë¼ìš°í„°ê°€ ì •ì˜í•œë‹¤. 

<br>
- `_document.js`, `_app.js` : 
	- ëª¨ë“  í˜ì´ì§€ë‚˜ ëª¨ë“  ì»´í¬ë„ŒíŠ¸ë“¤ì— ê³µí†µì ìœ¼ë¡œ ì ìš©ë˜ëŠ” ë¡œì§ì´ë‚˜ ë°ì´í„°ë¥¼ ë‹¤ë£¨ëŠ” ì»´í¬ë„ŒíŠ¸ì´ë‹¤. `_app.js`ëŠ” ëª¨ë“  ì»´í¬ë„ŒíŠ¸ë“¤ì˜ ë£¨íŠ¸ ì»´í¬ë„ŒíŠ¸ë¥¼ ì˜ë¯¸í•œë‹¤.

<br><br>

#### a. Page Router ë¼ìš°íŒ… ê³¼ì • ë° `_app.js` ì»´í¬ë„ŒíŠ¸ ê°œë…**

- 1) `/about` ê²½ë¡œë¥¼ ìš”ì²­í•˜ë©´, ì²«ì§¸ë¡œ, pages ë””ë ‰í† ë¦¬ ë‚´ë¶€ì—ì„œ `about.js`ë¼ëŠ” íŒŒì¼ì„ ì°¾ëŠ”ë‹¤.

<br>

- 2) ë‘˜ì§¸ë¡œ, í•´ë‹¹ `about.js` íŒŒì¼ì—ì„œ ë‚´ë¶€ì—ì„œ React ì»´í¬ë„ŒíŠ¸ë¥¼ ë‚´ë³´ë‚¸ë‹¤.(í˜„ì¬ëŠ” AboutPageë¼ëŠ” React ì»´í¬ë„ŒíŠ¸)
	- about.js

```js
export default function AboutPage() {
  return <div>About Page</div>;
}

```

<br>

- 3) ë‚´ë³´ë‚¸ React ì»´í¬ë„ŒíŠ¸ë¥¼ `_app.js` íŒŒì¼ ë‚´ë¶€ì˜ `Component Props`ë¡œ ì „ë‹¬í•˜ì—¬ ì´ë ‡ê²Œ ë Œë”ë§ë˜ê³  í•´ë‹¹ í˜ì´ì§€ê°€ ì‚¬ìš©ìì—ê²Œ ì‘ë‹µëœë‹¤.
	- App.js

```js
import "@/styles/globals.css";

export default function App({ Component, pageProps }) {
  return <Component {...pageProps} />;
}

```

<br><br>

#### b. `_document.js` ì»´í¬ë„ŒíŠ¸ ê°œë…

- `_document.js` : 
	- ëª¨ë“  í˜ì´ì§€ì— ì ìš©ë˜ëŠ” html ì½”ë“œë“¤ì´ë‹¤.(í°íŠ¸ë‚˜ ë©”íƒ€íƒœê·¸(ogTag), Character-Set, ì„œë“œíŒŒí‹°ìŠ¤í¬ë¦½íŠ¸ ë“±ì˜ ì„¤ì •ê³¼ ê·¸ëŸ° ê²ƒë“¤)
	- ì¦‰, React.jsì—ì„œì˜ index.html ì—­í• ì´ë‹¤. ê»ë°ê¸° ì—­í• 


---

<br><br>


### 2) Page Router ì‹¤ìŠµ

- useRouterë¥¼ ì´ìš©í•˜ì—¬ ë¼ìš°íŒ…ì— ê´€í•œ ì •ë³´ë¥¼ ì–»ì–´ì˜¬ ìˆ˜ ìˆëŠ”ë° ì´ëŸ¬í•œ ë°©ì‹ìœ¼ë¡œ 'ì¿¼ë¦¬ìŠ¤íŠ¸ë§'ì˜ ì¸ì ê°’ì„ ê°€ì ¸ì˜¨ë‹¤.

<br>
- `/pages/country/[code].js`

```js
import { useRouter } from "next/router";

export default function Country() {
  const router = useRouter();
  const { code } = router.query;

  return <div>Country {code}</div>;
}

```


<br>

#### a. Page Router ë¼ìš°íŒ… ê³¼ì •**

- 1) `/about` ê²½ë¡œë¥¼ ìš”ì²­í•˜ë©´, ì²«ì§¸ë¡œ, pages ë””ë ‰í† ë¦¬ ë‚´ë¶€ì—ì„œ `about.js`ë¼ëŠ” íŒŒì¼ì„ ì°¾ëŠ”ë‹¤.

<br>

- 2) ë‘˜ì§¸ë¡œ, í•´ë‹¹ `about.js` íŒŒì¼ì—ì„œ ë‚´ë¶€ì—ì„œ React ì»´í¬ë„ŒíŠ¸ë¥¼ ë‚´ë³´ë‚¸ë‹¤.(í˜„ì¬ëŠ” AboutPageë¼ëŠ” React ì»´í¬ë„ŒíŠ¸)
	- about.js

```js
export default function AboutPage() {
  return <div>About Page</div>;
}

```

<br>

- 3) ë‚´ë³´ë‚¸ React ì»´í¬ë„ŒíŠ¸ë¥¼ `_app.js` íŒŒì¼ ë‚´ë¶€ì˜ `Component Props`ë¡œ ì „ë‹¬í•˜ì—¬ ì´ë ‡ê²Œ ë Œë”ë§ë˜ê³  í•´ë‹¹ í˜ì´ì§€ê°€ ì‚¬ìš©ìì—ê²Œ ì‘ë‹µëœë‹¤.
	- App.js

```js
import "@/styles/globals.css";

export default function App({ Component, pageProps }) {
  return <Component {...pageProps} />;
}

```


---

<br><br>

### 3) Page ì´ë™í•˜ê¸°

#### a. Page ì´ë™í•˜ê¸°ì˜ ì²«ë²ˆì§¸ ë°©ì‹ : `Link` ì»´í¬ë„ŒíŠ¸ ì´ìš©

- í˜ì´ì§€ë¥¼ ì´ë™í•˜ê¸° ìœ„í•´ì„œ `Link` ì»´í¬ë„ŒíŠ¸ë¥¼ ì´ìš©í•˜ê¸°! Next.jsì—ì„œëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì œê³µí•˜ëŠ” í•´ë‹¹ ì»´í¬ë„ŒíŠ¸ë¡œì„œ CSR ë°©ì‹ìœ¼ë¡œ í˜ì´ì§€ ì´ë™ì´ ê°€ëŠ¥í•˜ë‹¤.

<br>
- í˜ì´ì§€ ì´ë™ì„ ìœ„í•´ ì„œë²„ì—ì„œ ìš”ì²­í•˜ì§€ ì•Šê³  ìì²´ì ìœ¼ë¡œ ì»´í¬ë„ŒíŠ¸ë¥¼ êµì²´í•˜ê¸° ë•Œë¬¸ì— íš¨ìœ¨ì ì´ë‹¤.

<br>
- ì‚¬ìš© ë°©ì‹ 1 : í…œí”Œë¦¿ ë¦¬í„°ëŸ´ ë°©ì‹, ê¸°ë³¸ ë¬¸ìì—´ë„ ê°€ëŠ¥, ê°„ë‹¨í•˜ë©´ ì´ë ‡ê²Œ ë¬¸ìì—´ë¡œ ì´ë™ì‹œí‚¤ê¸°!!
	- `<Link href={\`/country/${code}\`}>`

<br>	
- ì‚¬ìš© ë°©ì‹ 2 : Url Objectë¼ëŠ” ê°ì²´ ì „ë‹¬í•˜ê¸°(`Link` ì»´í¬ë„ŒíŠ¸ì˜ ì†ì„±ìœ¼ë¡œ `href={}` ì†ì„±ì— í•´ë‹¹ ê°ì²´ ë„£ê¸°), ë¦¬í„°ëŸ´ ê°ì²´ í˜•ì‹ì´ë‹¤.
	- `pathname: "/country/[code]",` : í•´ë‹¹ í˜ì´ì§€ë¥¼ ë‹´ë‹¹í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ê°€ ì‘ì„±ëœ íŒŒì¼ì˜ ì´ë¦„ì„ ë„£ê¸°
	- `query: { code: code },`

<br><br>

#### b. Page ì´ë™í•˜ê¸°ì˜ ë‘ë²ˆì§¸ ë°©ì‹ : `useRouter` ì»´í¬ë„ŒíŠ¸ ì´ìš©

- ì´ë²¤íŠ¸ì— ê´€í•˜ì—¬ í˜ì´ì§€ê°€ ì´ë™í•˜ë„ë¡ í•˜ê¸° ìœ„í•´ì„œëŠ” ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ì— `useRouter` ì»´í¬ë„ŒíŠ¸ ì´ìš©í•˜ê¸°

<br>	
- React.jsì²˜ëŸ¼ router.push() ì´ìš©í•˜ê¸°! `useRouter` ì»´í¬ë„ŒíŠ¸ì—ëŠ” pushë§ê³ ë„ back, replace, reload ë“± ì—¬ëŸ¬ ìƒí™©ì— ë§ëŠ” ì—¬ëŸ¬ê°€ì§€ ë©”ì„œë“œë“¤ì´ ìˆë‹¤. 
	- `useRouter`ì— ê´€í•˜ì—¬ ê³µì‹ë¬¸ì„œë¥¼ ì°¸ê³ í•˜ì—¬ ë©”ì„œë“œ ì—­í•  ì•Œì•„ë³´ê¸°!!

<br><br>

#### c. ì‹¤ìŠµ ì½”ë“œ 

- index.js

```js
import Link from "next/link";
import { useRouter } from "next/router";

export default function Home() {
  const code = "KOR";

  const router = useRouter();

  const onClickButton = () => {
    router.push({
      pathname: "/country/[code]",
      query: { code: code },
    });
  };

  return (
    <div>
      Home Page
      <div>
        <button onClick={onClickButton}>
          Search í˜ì´ì§€ë¡œ ì´ë™
        </button>
      </div>
      <div>
        <Link `={"/search"}>Search Page ì´ë™</Link>
      </div>
      <div>
        <Link
          href={ {
            pathname: "/country/[code]",
            query: { code: code },
          } }
        >
          {code} í˜ì´ì§€ë¡œ ì´ë™
        </Link>
      </div>
    </div>
  );
}

```

---

<br><br>

### 4) ê³µí†µìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ë ˆì´ì•„ì›ƒ ì„¤ì •í•˜ê¸°

- React.jsì™€ ê°™ì€ ë°©ì‹ìœ¼ë¡œì„œ `Layout.js` ì»´í¬ë„ŒíŠ¸ì— ê³µí†µ ë ˆì´ì•„ì›ƒì„ ì„¤ê³„!!

<br>
- Layout ì»´í¬ë„ŒíŠ¸ì—ì„œ `'children'`ìœ¼ë¡œ í˜ì´ì§€ ì—­í• ì„ í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ë¥¼ main íƒœê·¸ì— ë Œë”ë§ ì‹œì¼œì„œ props ì‹œí‚¨ë‹¤.

<br>
- Next.js ì•±ì˜ í˜ì´ì§€ ì „ì²´ì— ìŠ¤íƒ€ì¼ì„ ë¨¹ì´ë ¤ë©´ `global.css`ì—ì„œ ì ìš©í•œë‹¤.

<br><br>

#### a. ì‹¤ìŠµ ì½”ë“œ 

- `Layout.js`

```js
import style from "./Layout.module.css";

export default function Layout({ children }) {
  return (
    <div>
      <header className={style.header}>NARAS ğŸŒ</header>
      <main className={style.main}>{children}</main>
    </div>
  );
}

```

<br>
- `Layout.module.css`

```css
.header {
  position: fixed;
  top: 0px;
  left: 0px;
  right: 0px;
  height: 50px;
  background-color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  cursor: pointer;
}

.main {
  max-width: 700px;
  margin: 0 auto;
  padding: 80px 10px;
}

```

<br>
- `_app.js`

```js
import "@/styles/globals.css";
import Layout from "@/components/Layout";

export default function App({ Component, pageProps }) {
  return (
    <Layout>
      <Component {...pageProps} />
    </Layout>
  );
}

```


<br>
- `styles/globals.css`


```css
html,
body {
  margin: 0px;
  background-color: rgb(245, 245, 245);
}

```


---

<br><br>

### 5) í˜ì´ì§€ë³„ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë ˆì´ì•„ì›ƒ ì„¤ì •í•˜ê¸°

- í˜ì´ì§€ë³„ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë ˆì´ì•„ì›ƒì„ ì„¤ì •í•˜ê¸° ìœ„í•´ì„œ `SubLayout`ì´ë‚˜ `Component.Layout` ì„¤ì •

<br>
- ì¤‘ìš”** : JS í•¨ìˆ˜ëŠ” ëª¨ë‘ ê°ì²´ì´ê¸° ë•Œë¬¸ì— ìš°ë¦¬ëŠ” ì´ì „ì— ì»´í¬ë„ŒíŠ¸ë¥¼ ë§Œë“¤ê¸° ìœ„í•´ì„œ `Search`ë¼ëŠ” í•¨ìˆ˜ë¥¼ ë§Œë“¤ì—ˆì§€ë§Œ ì‚¬ì‹¤ì€ ê°ì²´ë¡œë„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
	- `Search.Layout = SubLayout;`
	- ì •ë¦¬í•˜ë©´, Search ì»´í¬ë„ŒíŠ¸ì˜ 'Layout'ì´ë¼ëŠ” í”„ë¡œí¼í‹°ë¥¼ ì¶”ê°€í•˜ê³  ê·¸ ê°’ì„ 'SubLayout' ì»´í¬ë„ŒíŠ¸ì— ì €ì¥í•œë‹¤ë¼ëŠ” ê°œë…ì´ë‹¤.

<br>
- ì¶”ê°€ì ì¸ ì—ëŸ¬ ë°œìƒ : `index` í˜ì´ì§€ëŠ” search, country í˜ì´ì§€ì™€ ë‹¬ë¦¬ Layoutì˜ ì´ˆê¸°ê°’ì„ SubLayoutì²˜ëŸ¼ ì„¤ì •í•˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— `undefined`ì´ ë°˜í™˜ë˜ì–´ ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤.
	- í•´ê²° ë°©ë²•** : ê·¸ë˜ì„œ, ì¶”ê°€ì ìœ¼ë¡œ SubLayoutì— `EmptyLayout`ì¸ ì•„ë¬´ê²ƒë„ ì—†ëŠ” Layoutì„ ë°˜í™˜í•˜ëŠ” ìº„í¬ë„ŒíŠ¸ë¥¼ ì„¤ì •í•˜ì—¬ undefined ì—ëŸ¬ë¥¼ í•´ê²°í•œë‹¤.

---

<br><br>

#### a. ì‹¤ìŠµ ì½”ë“œ : 

- SubLayout.js

```js
import style from "./SubLayout.module.css";

export default function SubLayout({ children }) {
  return (
    <div className="SubLayout">
      <div>{children}</div>
      <footer className={style.footer}>@winterlood</footer>
    </div>
  );
}

```

<br>
- SubLayout.module.css

```css
.footer {
  border-top: 1px solid rgb(230, 230, 230);
  padding-top: 20px;
  margin-top: 20px;
  text-align: center;
  color: gray;
  font-size: 14px;
}

```


<br>
- `/pages/country/[code].js`

```js
import SubLayout from "@/components/SubLayout";
import { useRouter } from "next/router";

export default function Country() {
  const router = useRouter();
  const { code } = router.query;

  return <div>Country {code}</div>;
}

Country.Layout = SubLayout;

```

<br>
- `/pages/search/index.js`

```js
import SubLayout from "@/components/SubLayout";

export default function Search() {
  return <div>Search Page</div>;
}

Search.Layout = SubLayout;

```

<br>
- `/pages/_app.js` : ì—ëŸ¬ ìˆ˜ì • í›„ 

```js
import "@/styles/globals.css";
import Layout from "@/components/Layout";

export default function App({ Component, pageProps }) {
  const EmptyLayout = ({ children }) => <>{children}</>;
  const SubLayout = Component.Layout || EmptyLayout;

  return (
    <Layout>
      <SubLayout>
        <Component {...pageProps} />
      </SubLayout>
    </Layout>
  );
}

```

- `/pages/_app.js` : ì—ëŸ¬ ìˆ˜ì • ì „, SubLayoutì´ Component.Layoutì˜€ë‹¤.

```js
import "@/styles/globals.css";
import Layout from "@/components/Layout";

export default function App({ Component, pageProps }) {
  return (
    <Layout>
      <Component.Layout>
        <Component {...pageProps} />
      </Component.Layout>
    </Layout>
  );
}

```


---

<br><br>


# 3. SSR ë Œë”ë§

### 1) SSRì— Props ì ìš©í•˜ê¸°

#### a. getServerSideProps vs Component function

- next.jsì—ì„œ `getServerSideProps` í•¨ìˆ˜ëŠ” SSR ì „ìš©, ì¼ë°˜ `ì»´í¬ë„ŒíŠ¸ í•¨ìˆ˜`ëŠ” CSR ì „ìš©ì´ë¼ì„œ 2ê°€ì§€ë¥¼ í˜¼ìš©í•´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
   - next.jsì—ì„œ ë³´í†µ `ë°ì´í„°ë¥¼ ë§Œë“¤ì–´ì˜¤ëŠ” ê³³`ì€ 'SSR' ë°©ì‹ìœ¼ë¡œ ì‚¬ìš©í•˜ê³ , `í™”ë©´ì— ë³´ì—¬ì£¼ëŠ” ìš©ë„`ì—ì„œëŠ” 'CSR' ë°©ì‹ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤.
  

<br>
- props** : ë°ì´í„°ëŠ” propsë¼ëŠ” í”„ë¡œí¼í‹°ë¡œ ì„¤ì •ë˜ë©° ê°ì²´ íƒ€ì…ì´ë‹¤. ë˜í•œ, SSRë¡œì„œ ì„œë²„ì˜ ë°ì´í„°ë¥¼ ë„˜ê²¨ë°›ì•„ Home ì»´í¬ë„ŒíŠ¸ë¡œ ë„˜ê²¨ì¤€ë‹¤.

<br>
- ì¤‘ìš”** : getServerSidePropsëŠ” ì„œë²„ ì¸¡ì—ì„œë§Œ ì‹¤í–‰ë˜ì–´ ì‚¬ìš©ëœë‹¤. ê·¸ë˜ì„œ console.logì—ëŠ” ì•ˆë³´ì´ê³  í„°ë¯¸ë„ì—ì„œ ë³¼ ìˆ˜ ìˆë‹¤. 
	- ì¦‰, window ê°ì²´ì—ëŠ” ì ‘ê·¼í•  ìˆ˜ ì—†ë‹¤.(ex) window.locationëŠ” ë¸Œë¼ìš°ì €ì—ì„œë§Œ ì ‘ê·¼ì´ ê°€ëŠ¥í•˜ë‹¤.)
	- ì¶”ê°€ì ìœ¼ë¡œ, ë¸Œë¼ìš°ì €ì—ì„œë§Œ console.logë¥¼ ë³´ê¸° ìœ„í•´ì„œëŠ” useEffect()ë¥¼ ì´ìš©í•œë‹¤.(ë§ˆìš´íŠ¸ ê°œë… ì‚¬ìš©)	


<br><br>

#### b. getServerSideProps ì‹¤ìŠµ ì½”ë“œ 

- `/pages/index.js`

```js
import { useEffect } from "react";

export default function Home({ name }) {
  console.log("HOME");

  useEffect(() => {
    console.log("HOME MOUNT");
  }, []);

  return <div>{name}</div>;
}

export const getServerSideProps = async () => {
  // SSRì„ ìœ„í•´ ì„œë²„ì¸¡ì—ì„œ í˜ì´ì§€ ì»´í¬ë„ŒíŠ¸ì—ê²Œ ì „ë‹¬í•  ë°ì´í„°ë¥¼ ì„¤ì •í•˜ëŠ” í•¨ìˆ˜

  return {
    props: {
      name: "KOREA",
    },
  };
};

```


---


<br><br>


### 2) SSRì— API ì ìš©í•˜ê¸°


#### a. useRouter vs context

- ì¤‘ìš”** : async-await ë°©ì‹ì˜ fetch API ë°ì´í„° ë°›ê¸°!!, API fetch ê²°ê³¼ì— ëŒ€í•œ ìœ íš¨ì„± ê²€ì‚¬ ë°©ë²•!!


<br>
- context** : `context` ê°ì²´ëŠ” ì„œë²„ì¸¡ì—ì„œ APIì˜ ë°ì´í„°ë¥¼ ì‚¬ìš©í•  ë•Œ, ì´ìš©í•œë‹¤. 
	- ì„œë²„ ì¸¡ì—ì„œ ì–´ë–¤ ë°ì´í„°ë¥¼ fetchí•˜ê¸° ìœ„í•´ì„œ ë¶ˆëŸ¬ì˜¨ë‹¤ë©´ `context` ê°ì²´ë¥¼ ì‚¬ìš©í•œë‹¤.

<br>
- useRouter** : `useRouter` ì»´í¬ë„ŒíŠ¸ëŠ” í´ë¼ì´ì–¸íŠ¸ì¸¡ì—ì„œ APIì˜ ë°ì´í„°ë¥¼ ì‚¬ìš©í•  ë•Œ, ì´ìš©í•œë‹¤.
	- `useRouter`ëŠ” Reactì˜ Hookì´ë¼ì„œ, ë¸Œë¼ìš°ì €ì—ì„œ í•˜ì´ë“œë ˆì´ì…˜ ê³¼ì •ì´ ì´ë£¨ì–´ì§€ê³ ë‚˜ì„œ ë™ì‘í• ìˆ˜ ìˆê²Œ ëœë‹¤. ì¦‰, í´ë¼ì´ì–¸íŠ¸ ì¸¡ì—ì„œë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
	
<br>
- í•˜ì´ë“œë ˆì´ì…˜ ê³¼ì •** : ë¸Œë¼ìš°ì €ê°€ Reactì—ì„œ ì‘ì—…ëœ JS ë²ˆë“¤ ì½”ë“œì™€ HTML ì½”ë“œë“¤ì„ ì„œë¡œ ì—°ê²°í•˜ëŠ” ê³¼ì •ì´ë‹¤.


<br><br>

#### b. useRouter vs context ì‹¤ìŠµ ì½”ë“œ 

- `/pages/search/index.js`

```js
import { fetchSearchResults } from "@/api";
import SubLayout from "@/components/SubLayout";

export default function Search({ countries }) {
  return (
    <div>
      {countries.map((country) => (
        <div key={country.code}>{country.commonName}</div>
      ))}
    </div>
  );
}

Search.Layout = SubLayout;

export const getServerSideProps = async (context) => {
  // 1. ê²€ìƒ‰ ê²°ê³¼ API í˜¸ì¶œ
  // 2. Props ë¦¬í„´

  const { q } = context.query;

  let countries = [];
  
  // 3. API fetch ê²°ê³¼ì— ëŒ€í•œ ìœ íš¨ì„± ê²€ì‚¬ !!
  if (q) {
    countries = await fetchSearchResults(q);
  }

  return {
    props: {
      countries,
    },
  };
};

```

<br>
- `/pages/coutry/[code].js`

```js
import { fetchCountry } from "@/api";
import SubLayout from "@/components/SubLayout";
import { useRouter } from "next/router";

export default function Country({ country }) {
  const router = useRouter();
  const { code } = router.query;

  return (
    <div>
      {country.commonName} {country.officialName}
    </div>
  );
}

Country.Layout = SubLayout;

export const getServerSideProps = async (context) => {
  const { code } = context.params;

  let country = null;
  
  // 3. API fetch ê²°ê³¼ì— ëŒ€í•œ ìœ íš¨ì„± ê²€ì‚¬ !!
  if (code) {
    country = await fetchCountry(code);
  }

  return {
    props: {
      country,
    },
  };
};

```

<br>
- `api.js`
	- ê¸°ì¡´ Naras í”„ë¡œì íŠ¸ apië¥¼ ê·¸ëŒ€ë¡œ ê°€ì ¸ì˜´

```js
import axios from "axios";

export async function fetchCountries() {
  try {
    const response = await axios.get(
      "https://naras-api.vercel.app/all"
    );
    return response.data;
  } catch (e) {
    return [];
  }
}

export async function fetchSearchResults(q) {
  try {
    const response = await axios.get(`
  https://naras-api.vercel.app/search?q=${q}
  `);

    return response.data;
  } catch (e) {
    return [];
  }
}

export async function fetchCountry(code) {
  try {
    const response = await axios.get(
      `https://naras-api.vercel.app/code/${code}`
    );
    return response.data;
  } catch (e) {
    return null;
  }
}

```


---

<br><br>


# 4. SSG ë Œë”ë§

### 1) SSG ë Œë”ë§ ê°œë… ì •ë¦¬


- SSG ë Œë”ë§ : `ì •ì  ì‚¬ì´íŠ¸ ìƒì„±`ë¼ê³  ë¶ˆë¦°ë‹¤. ë Œë”ë§ ì „ëµ ì¤‘ í•˜ë‚˜ì´ë‹¤.

<br>
- ìƒì„± ê³¼ì • : ì„œë²„ ì¸¡ì—ì„œ í˜ì´ì§€ë¥¼ ë¹Œë“œ íƒ€ì„ì— í•œë²ˆë§Œ ë Œë”ë§ í•˜ëŠ” ê²ƒì´ë‹¤. í˜ì´ì§€ë¥¼ ì–¸ì œ ìƒì„±í•˜ëŠ”ê°€ê°€ SSRê³¼ SSGì˜ ì°¨ì´ì ì´ë‹¤.
	- ë°°í¬í•  ë•Œ, ë¹Œë“œë¥¼ í•˜ê²Œ ë˜ëŠ”ë° ì´ë ‡ê²Œ ë¹Œë“œ íƒ€ì„ì— ë¯¸ë¦¬ ìƒì„±ì´ ë˜ëŠ” ê²ƒì´ SSG ë°©ì‹ì´ë‹¤. 

<br>
- ì¥ì  : ì‚¬ìš©ìì˜ ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´, ì‘ë‹µ ì†ë„ê°€ SSR ë°©ì‹ë³´ë‹¤ ë§¤ìš° ë¹ ë¥´ë‹¤.

<br>
- ë‹¨ì  : í•˜ì§€ë§Œ, ì–¸ì œ ìš”ì²­í•´ë„ ë˜‘ê°™ì€ í˜ì´ì§€ë§Œ ì‘ë‹µí•˜ê²Œ ë˜ì–´ ìµœì‹  ë°ì´í„°ë¥¼ ë°˜ì˜í•  ìˆ˜ ì—†ë‹¤.
	- ê·¸ë˜ì„œ, í˜ì´ì§€ ë‚´ë¶€ ë°ì´í„°ê°€ ë³€ê²½ë˜ì§€ ì•ŠëŠ” í˜ì´ì§€ì— ì ì ˆí•œ ë Œë”ë§ ì „ëµì´ë‹¤. 
	
---

<br><br>

### 2) SSG ì ìš©í•˜ê¸° 1

- `getStaticProps`** : 
	- `getStaticProps`ëŠ” ì •ì ìœ¼ë¡œ ë¯¸ë¦¬ ë§Œë“¤ì–´ ë†“ì„ í˜ì´ì§€ë¥¼ ì„¤ì •í•œë‹¤.

<br>

#### a. ë¹Œë“œ ì‹œ, console.logì˜ í„°ë¯¸ë„ ì •ë¦¬

- ê°œë°œ ëª¨ë“œ** : SSRì´ë˜ SSGë˜ í¸ì˜ë¥¼ ìœ„í•´ì„œ, í•´ë‹¹ í•¨ìˆ˜ ë‚´ë¶€ì— ìˆëŠ” console.logëŠ” í„°ë¯¸ë„ì—ì„œ ì—¬ëŸ¬ ë²ˆ í˜¸ì¶œëœë‹¤.

<br>
- ë¹Œë“œ ëª¨ë“œ** : í•´ë‹¹ í•¨ìˆ˜ ë‚´ë¶€ì— ìˆëŠ” console.logëŠ” ë¹Œë“œ íƒ€ì„ì‹œ, í„°ë¯¸ë„ì—ì„œ 1ë²ˆ í˜¸ì¶œëœë‹¤.


<br>

#### b. ì‹¤ìŠµ ì½”ë“œ : 

- `/pages/index.js`

```js
import { fetchCountries } from "@/api";
import { useEffect } from "react";

export default function Home({ countries }) {
  return (
    <div>
      {countries.map((country) => (
        <div key={country.code}>{country.commonName}</div>
      ))}
    </div>
  );
}

export const getStaticProps = async () => {
  // API í˜¸ì¶œ ì½”ë“œê°€ í•„ìš”í•¨

  const countries = await fetchCountries();
  console.log("countries ë°ì´í„° ë¶ˆëŸ¬ì˜´");

  return {
    props: {
      countries,
    },
  };
};

```





---

<br><br>

### 3) SSG ì ìš©í•˜ê¸° 2


- `getStaticProps` : 
	- `getServerSideProps`ì™€ ë¹„êµí•˜ì—¬ `getStaticProps`ë¥¼ ì´ìš©í•˜ëŠ”ë°, ë¯¸ë¦¬ ë§Œë“¤ì–´ ë†“ëŠ” í˜ì´ì§€ë¥¼ ì„¤ì •í•œë‹¤.
	- ì¶”ê°€ì ìœ¼ë¡œ ë™ì  ê²½ë¡œë¥¼ ì„¤ì •í•˜ê¸° ìœ„í•´ì„œëŠ” `getStaticPaths`ê°€ í•„ìš”í•˜ë‹¤.

<br>
- `getStaticPaths` : 
	- ë™ì  ê²½ë¡œì—ì„œëŠ” ì–´ë–¤ í˜ì´ì§€ë“¤ì„ ë¯¸ë¦¬ ë¹Œë“œíƒ€ì„ì— ìƒì„±í• ê±´ì§€ ë¯¸ë¦¬ ëª…ì‹œí•´ì•¼ í•œë‹¤. ì´ë™ì‹œí‚¬ í˜ì´ì§€ ì„¤ì •!!

<br>
- getStaticPaths ë‚´ìš©ëŒ€ë¡œ ë¹Œë“œë¥¼ í•˜ë©´, getStaticPathsì˜ pathsì—ì„œ params ì„¤ì •ëŒ€ë¡œ ì´ë™ì‹œí‚¬ íŒŒì¼ì´ ë¯¸ë¦¬ ìƒì„±ëœë‹¤.
	- `./next/server/pages` : ë¹Œë“œ ê´€ë ¨ í˜ì´ì§€ë“¤ì´ ì—¬ê¸°ì— ì €ì¥ëœë‹¤.
		- `ABW.html`, `KOP.html`ìœ¼ë¡œ ì‚¬ì „ì— SSG ë°©ì‹ìœ¼ë¡œ ìƒì„±

<br>

#### a. ë¹Œë“œ ì‹œ, í„°ë¯¸ë„ ì •ë¦¬

- ë¹Œë“œ í›„ í„°ë¯¸ë„ì˜ í•˜ì–€ìƒ‰ ë™ê·¸ë¼ë¯¸** : getStaticProps í•¨ìˆ˜ë¥¼ ì„¤ì •í•˜ì—¬ SSG ë°©ì‹ìœ¼ë¡œ ì„¤ì •ëœ ê²½ìš°

<br>
- ë¹Œë“œ í›„ í„°ë¯¸ë„ì˜ ê²€ì€ìƒ‰ ë™ê·¸ë¼ë¯¸** : ì–´ë–¤ ì»´í¬ë„ŒíŠ¸ì— getStaticPropsë¼ëŠ” í•¨ìˆ˜ë¥¼ ì„¤ì •í•˜ì§€ ì•Šì•„ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ì•Šê³  ì§„ì§œë¡œ ì •ì ì¸ í˜ì´ì§€ì¼ ê²½ìš°


<br>

#### b. ì‹¤ìŠµ ì½”ë“œ : 

- `/pages/country/[code].js`

```js
import { fetchCountry } from "@/api";
import SubLayout from "@/components/SubLayout";
import { useRouter } from "next/router";

export default function Country({ country }) {
  const router = useRouter();
  const { code } = router.query;

  if (router.isFallback) {
    return <div>Loading ...</div>;
  }

  if (!country) {
    return <div>ì¡´ì¬í•˜ì§€ ì•ŠëŠ” êµ­ê°€ì…ë‹ˆë‹¤</div>;
  }

  return (
    <div>
      {country.commonName} {country.officialName}
    </div>
  );
}

Country.Layout = SubLayout;

export const getStaticPaths = async () => {
  return {
    paths: [
      { params: { code: "ABW" } },
      { params: { code: "KOR" } },
    ],
    fallback: false,
  };
};

export const getStaticProps = async (context) => {
  const { code } = context.params;

  let country = null;
  if (code) {
    country = await fetchCountry(code);
  }

  return {
    props: {
      country,
    },
  };
};

```





---

<br><br>

### 4) SSG ì ìš©í•˜ê¸° 3

- getStaticPaths í•¨ìˆ˜ì˜ fallback ì†ì„± ê°œë… :

#### a. ì‹¤ìŠµ ì½”ë“œ 

- `/pages/country/[code].js`

```js
import { fetchCountry } from "@/api";
import SubLayout from "@/components/SubLayout";
import { useRouter } from "next/router";

export default function Country({ country }) {
  const router = useRouter();
  const { code } = router.query;

  if (router.isFallback) {
    return <div>Loading ...</div>;
  }

  if (!country) {
    return <div>ì¡´ì¬í•˜ì§€ ì•ŠëŠ” êµ­ê°€ì…ë‹ˆë‹¤</div>;
  }

  return (
    <div>
      {country.commonName} {country.officialName}
    </div>
  );
}

Country.Layout = SubLayout;

export const getStaticPaths = async () => {
  return {
    paths: [
      { params: { code: "ABW" } },
      { params: { code: "KOR" } },
    ],
    fallback: true,
  };
};

export const getStaticProps = async (context) => {
  const { code } = context.params;

  let country = null;
  if (code) {
    country = await fetchCountry(code);
  }

  return {
    props: {
      country,
    },
  };
};

```








---


<br><br>

### 5) SSG ì ìš©í•˜ê¸° 4














	