---
key: /2023/04/24/Week22-Day.html
title: TIL - 22주차 코드
tags: javascript DOM css
toc: true
toc_sticky: true
---

# 1. JS : 230424

### 1) CSS 애니메이션 이벤트 객체

- 애니메이션가 동작하다가 멈추면, 각 엘리먼트들이 자리 바뀜.

- dom.js

```javascript
// 4-2. 이벤트 객체
{
    let s1 = document.querySelector(".s2");
    let ul = s1.querySelector("ul");
    let current = null; // ul.querySelectorAll("li.current");
    let lis = ul.querySelectorAll("li");

    for(let li of lis)
        li.onclick = function(e){

            if(current){
                
                // *** 실습 3 : 애니메이션 

                let selected = e.target.parentElement;
                while(selected.tagName !== 'LI')
                    selected = e.parentElement;

                selected.classList.add("selected");

                // onanimationend 애니메이션 끝나고 동작하는 것이 end이다.
                selected.onanimationend = function(){
                    selected.classList.remove("selected");
                    let selectedBefore = selected.previousElementSibling;

                    current.replaceWith(selected);
                    if(selectedBefore)
                        selectedBefore.after(current);
                    else
                        ul.prepend(current);
                    
                    current.classList.remove("current");

                    current = null;
                    
                }


                return;
            }

```

---

<br><br>
- dom.html

```html
    <section class="s2">
        <h1>이미지목록</h1>
        <style>
            @keyframes zoomIn {
                from {
                    transform: scale(1,1);
                }
                /* 중간에 중간단계로서 50%의 동작도 구현할 수 있다. */
                30%{
                    transform: rotate3d(1,1,1,90deg);
                }
                60%{
                    transform: rotate3d(2,-1,-1,-0.5turn);
                }
                to {
                    transform: scale(1.2,1.2);
                }
            }
            
            @keyframes selectedani {
                from {
                    transform: scale(1,1);
                }
                /* 중간에 중간단계로서 50%의 동작도 구현할 수 있다. */
                30%{
                    transform: rotate3d(1,1,1,90deg);
                }
                60%{
                    transform: rotate3d(2,-1,-1,-0.5turn);
                }
                to {
                    transform: scale(1.2,1.2);
                }
            }
            .s2 ul{
                padding: 0;
                list-style-type: none;
                display: flex;                
            }            

            .s2 span{
                display: inline-flex;                
                width:100px;
                height: 100px;
                align-items: center;
                justify-content: center;
                color: white;
                font-weight: bold;
                background-color: blue;

                /* 시간 초 딜레이 넣기 */
                /* transition: 0.5s; */
            }

            /* 여기서 li.current가 되는구나 JS를 굳이 안써도 된다. */
            .s2 li.current .box,
            .s2 li.current span
            {
                box-sizing: border-box;
                background-color: red;
                border:3px solid yellow;
                /* 박스를 사이즈를 키울 때, 전체 사이즈를 안 밀리고 싶으면 tranform을 이용한다! */
                /* 다른 것에 영향을 주지 않고 사이즈를 늘릴 수 있다. 그래서 tranform을 사용함. */
                /* transform: scale(1.2,1.2); */

                /* 애니메이션 이용하기! */
                animation-name: zoomIn;
                animation-duration: .5s;     /* 반복 시간 */
                animation-iteration-count: infinite;    /* 반복 횟수 */
                animation-direction: alternate;
            }      

            .s2 li.selected .box,
            .s2 li.selected span
            {
                /* 애니메이션 이용하기! */
                animation-name: selectedani;
                animation-duration: 2s;     /* 반복 시간 */
                animation-direction: alternate;
            }        
        </style>
        <ul>
            <!-- 기존보다 구조가 달라지면 문제가 생김. -->
            <li><span>1</span></li>
            <li>
                <div>
                    <span>2</span>
                </div>
            </li>
            <li><span>3</span></li>
            <li><span>4</span></li>
        </ul>
    </section>
    <hr>

```


---

<br><br>

### 2) 목록을 키보드로 관리 (DOM)

- 키보드를 이용해서 엘리먼트들을 관리하고 삭제할 수 있다.

- dom.js

```javascript

// .s3 목록을 키보드로 관리!!
{
    let s = document.querySelector(".s3");
    let ul = s.querySelector("ul");
    let current = null;
    let lis = ul.querySelectorAll("li");
    let delButton = s.querySelector(".btn-del");
    s.focus();

    s.onkeydown = function(e){
        console.log("key down");
        console.log(`code:${e.code}, key:${e.key}, keyCode:${e.keyCode}`);
        
        // if(e.code === 'Delete'){

        //     let selectedButtons = [...ul.querySelectorAll("input:checked")]
        //                         .map(a=>a.parentElement);

        //     for(let li of selectedButtons)
        //         li.remove();
        // }
        if(e.code === 'Delete'){
            // Trigger 함수 : 이벤트 !!
            // click 누르는 이벤트에서 가능
            const event = new Event("click");
            delButton.dispatchEvent(event); // 이게 Trigger이다. 이벤트에 방아쇄를 당김.
        }
    }

    delButton.onclick = function(){
        // let selectedButtons = e.target.value;
        // console.log(selectedButtons);
        // let selectedButtons = ul.querySelectorAll(".selected");
        // let selectedButtons = ul.querySelectorAll("input:checked");

        // *** JS Spread Operator(연산자) 문법 ***
        // 개별 요소로 분배 가능!!
        let selectedButtons = [...ul.querySelectorAll("input:checked")]
                                .map(a=>a.parentElement);
        

        // let arr = [1,2,3];

        // ** For Each : for each는 하나씩 꺼내서 사용한다.
        // ** Map : 하나씩 꺼내서 다른 형태로 바꿔줄 때!! map을 이용한다.
        // arr.forEach(a => console.log(a+1));

        // let arr1 = arr.map(a=>`<a id=${a}>`);
        // console.log(arr1);

        for(let li of selectedButtons)
            li.remove();

        
    }

    ul.onclick = function(e){
        // console.log(`clicked: ${e.target}`);
        // console.log(`clicked: ${e.target}`);
        if(e.target.tagName !== 'SPAN')
            return;

        let selected = e.target.parentElement;

        while(selected.tagName !== 'LI'){
            selected = selected.parentElement;
            // 'e.parentElement'가 아니라 'selected.parentElement'이다.
        }

        selected.classList.add("selected");
    }
}

```

---

<br><br>

- dom.html

```html
    <section tabindex="0" class="s3">
        <h1>이미지목록</h1>
        <style>
            .s3 ul{
                padding: 0;
                list-style-type: none;
                display: flex;                
            }            

            .s3 span{
                display: inline-flex;                
                width:100px;
                height: 100px;
                align-items: center;
                justify-content: center;
                color: white;
                font-weight: bold;
                background-color: blue;

                /* 시간 초 딜레이 넣기 */
                /* transition: 0.5s; */
            }

            /* 여기서 li.current가 되는구나 JS를 굳이 안써도 된다. */
            .s3 li.current .box,
            .s3 li.current span
            {
                box-sizing: border-box;
                background-color: red;
                border:3px solid yellow;
                /* 박스를 사이즈를 키울 때, 전체 사이즈를 안 밀리고 싶으면 tranform을 이용한다! */
                /* 다른 것에 영향을 주지 않고 사이즈를 늘릴 수 있다. 그래서 tranform을 사용함. */
                /* transform: scale(1.2,1.2); */

                /* 애니메이션 이용하기! */
                animation-name: zoomIn;
                animation-duration: .5s;     /* 반복 시간 */
                animation-iteration-count: infinite;    /* 반복 횟수 */
                animation-direction: alternate;
            }      

            .s3 li.selected .box,
            .s3 li.selected span
            {
                /* 애니메이션 이용하기! */
                animation-name: selectedani;
                animation-duration: 2s;     /* 반복 시간 */
                animation-direction: alternate;
            }        
        </style>
        <div>
            <button class="btn-del">삭제</button>
        </div>
        <ul>
            <!-- 기존보다 구조가 달라지면 문제가 생김. -->
            <li><input type="checkbox"></input><span>1</span></li>
            <li><input type="checkbox"></input>
                <div>
                    <span>2</span>
                </div>
            </li>
            <li><input type="checkbox"></input><span>3</span></li>
            <li><input type="checkbox"></input><span>4</span></li>
        </ul>
    </section>
    <hr>
```

---

<br><br>

### 3) 파일 드래그앤드랍 DOM

- dom.js

```javascript
window.addEventListener("load",function(){

// .s4 and drop ai
{
    let s = this.document.querySelector(".s4");
    let dropZone = s.querySelector(".drop-zone");

    dropZone.ondragenter = function(e){
        console.log("enter");


    }
    dropZone.ondragover = function(e){
        e.preventDefault();

        // 드래그한게 '파일'이면 true 아니면 false
        if(e.dataTransfer.types[0]=="Files"){
            dropZone.classList.add("valid");
            dropZone.classList.remove("invalid");
        }
        else{
            dropZone.classList.add("invalid");
            dropZone.classList.remove("valid");
        }   

        // ** Over에서는 초당 이벤트가 발생해서 파일 정보를 가져올 수 없다!!
        // 그래서, Drop으로 이벤트 옮기기!!
        // let file = e.dataTransfer.files  ;
        // if(file.length > 1){
        //     console.log("하나 이상의 파일은 업로드할 수 없습니다.");
        // }

        console.log("over");

        if(e.dataTransfer.files.length > 1){
            console.log("하나 이상의 파일은 업로드할 수 없습니다.");
        }
    }
    dropZone.ondragleave = function(e){
        console.log("leave");
    }
    dropZone.ondrop = function(e){
        // 브라우저가 기본적으로 파일을 읽기 때문에 기본 속성 날리기!
        // over에도 drop처럼 preventDefault로 같이 날려주기!!

        e.preventDefault(); 
        console.log(e.dataTransfer.type);
        // console.log("drop");

        if(e.dataTransfer.files.length > 1){
            console.log("하나 이상의 파일은 업로드할 수 없습니다.");
        }
    }
    
}
```

---

<br><br>
- dom.html

```html
    <!-- 드래그 드랍은 파일 자체인 컨텐트를 끌어다가 파일을 옮겨야 한다. -->
    <section class="s4">
        <style>
            .s4 .drop-zone{
                box-sizing: border-box;
                width: 500px;
                height: 400px;
                border: 1px solid gray;
                background-color: beige;
            }
            .s4 .drop-zone.valid{
                background-color: greenyellow;
            }

            .s4 .drop-zone.invalid{
                background-color: red;
            }

            .s4 .box-zone{
                display: flex;
            }
            .s4 .box{
                box-sizing: border-box;
                width: 100px;
                height: 100px;
                background-color: green;
            }
        </style>
        <h1>Drag and Drop API</h1>
        <div class="drop-zone">
        </div>
        <div class="box-zone">
            <div draggable="true" class="box">1</div>
            <div class="box">2</div>
            <div class="box">3</div>
            <div class="box">4</div>
        </div>
    </section>
```




---


<br><br>

# 2. 230425


